-----

````markdown
#feature-importance-comparison

–£—Ç–∏–ª–∏—Ç—ã –∏ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã –¥–ª—è —Å—Ä–∞–≤–Ω–µ–Ω–∏—è –º–µ—Ç–æ–¥–æ–≤ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –í–∞–∂–Ω–æ—Å—Ç–∏ –ü—Ä–∏–∑–Ω–∞–∫–æ–≤ (Feature Importance - FI) –≤ –º–æ–¥–µ–ª—è—Ö Random Forest —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤:
1.  Scikit-learn (Python) —Å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —á–µ—Ä–µ–∑ Optuna.
2.  R (—á–µ—Ä–µ–∑ rpy2) —Å –ø–∞–∫–µ—Ç–∞–º–∏ randomForest –∏ ranger.

–ü—Ä–æ–µ–∫—Ç –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –≤–∞–∂–Ω–æ—Å—Ç–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –∏–∑ —Ä–∞–∑–Ω—ã—Ö —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–π, —á—Ç–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ –¥–ª—è –Ω–∞–¥–µ–∂–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –¥–∞–Ω–Ω—ã—Ö.

---

#–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

| –ü—É—Ç—å | –û–ø–∏—Å–∞–Ω–∏–µ |
| :--- | :--- |
| src/feature_importance_pkg/__init__.py | –ì–ª–∞–≤–Ω—ã–π —Ñ–∞–π–ª –ø–∞–∫–µ—Ç–∞, –æ–ø—Ä–µ–¥–µ–ª—è—é—â–∏–π –ø—É–±–ª–∏—á–Ω—ã–π API –∏ —É–ø—Ä–∞–≤–ª—è—é—â–∏–π –∏–º–ø–æ—Ä—Ç–æ–º –æ—Å–Ω–æ–≤–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π. |
| src/feature_importance_pkg/python_implementations.py | –°–æ–¥–µ—Ä–∂–∏—Ç —Ñ—É–Ω–∫—Ü–∏–∏ –Ω–∞ Python —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º sklearn –∏ optuna –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ (HPO) –∏ —Ä–∞—Å—á–µ—Ç–∞ FI. |
| src/feature_importance_pkg/r_implementations.py | –°–æ–¥–µ—Ä–∂–∏—Ç —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å R-–ø–∞–∫–µ—Ç–∞–º–∏ randomForest –∏ ranger —á–µ—Ä–µ–∑ rpy2. |
| src/feature_importance_pkg/pic.py | –°–æ–¥–µ—Ä–∂–∏—Ç —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ (–ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è —Å—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –≥—Ä–∞—Ñ–∏–∫–æ–≤) –≤–∞–∂–Ω–æ—Å—Ç–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤. |
| requirements.txt | –°–ø–∏—Å–æ–∫ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π Python. |

---

## üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

–î–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã –≤—Å–µ–≥–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º **Python 3.x** –∏ **R**.

### –®–∞–≥ 1: –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ Python

–ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ Python.

```bash
# –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
git clone [https://github.com/Nikita23112/Skoltech.git](https://github.com/Nikita23112/Skoltech.git)
cd Skoltech/

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π Python
# –í–∫–ª—é—á–∞–µ—Ç scikit-learn, optuna, pandas, numpy, rpy2 –∏ –¥—Ä.
pip install -r requirements.txt 
````

### –®–∞–≥ 2: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ R-–ø–∞–∫–µ—Ç–æ–≤ (–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–ª—è —Ñ—É–Ω–∫—Ü–∏–π R)

–î–ª—è —Ñ—É–Ω–∫—Ü–∏–π, –∏—Å–ø–æ–ª—å–∑—É—é—â–∏—Ö `rpy2`, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ, —á—Ç–æ–±—ã –≤ –≤–∞—à–µ–π R-—Å—Ä–µ–¥–µ –±—ã–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –ø–∞–∫–µ—Ç—ã: `randomForest` –∏ `ranger`.

–í—ã –º–æ–∂–µ—Ç–µ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∏—Ö –≤ –∫–æ–Ω—Å–æ–ª–∏ R:

```r
install.packages(c("randomForest", "ranger"))
```

-----

## üõ†Ô∏è –§—É–Ω–∫—Ü–∏–∏ –∏ –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è (API)

–í–µ—Å—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –¥–æ—Å—Ç—É–ø–µ–Ω –¥–ª—è –∏–º–ø–æ—Ä—Ç–∞ –∏–∑ –ø–∞–∫–µ—Ç–∞ `feature_importance_pkg`.

### 1\) Python/Scikit-learn + Optuna (HPO –∏ FI)

–§—É–Ω–∫—Ü–∏—è –≤—ã–ø–æ–ª–Ω—è–µ—Ç –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ (**HPO**) –¥–ª—è `RandomForestClassifier` —Å –ø–æ–º–æ—â—å—é **Optuna** –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≤–∞–∂–Ω–æ—Å—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ (**FI**) –∏–∑ –ª—É—á—à–µ–π –º–æ–¥–µ–ª–∏.

```python
from feature_importance_pkg import sklearn_importance

# –ü—Ä–µ–¥–ø–æ–ª–∞–≥–∞–µ–º, —á—Ç–æ X_train –∏ y_train ‚Äî —ç—Ç–æ pd.DataFrame –∏ pd.Series
# X_train: –ø—Ä–∏–∑–Ω–∞–∫–∏, y_train: —Ü–µ–ª–µ–≤–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è
fi_sklearn, model, study = sklearn_importance(X_train, y_train)

print("–õ—É—á—à–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:", study.best_params)
print("–¢–æ–ø-5 –≤–∞–∂–Ω—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ (Scikit-learn):\n", fi_sklearn.head())
```

| –§—É–Ω–∫—Ü–∏—è | –û—Å–Ω–æ–≤–Ω–æ–µ –Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ | –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç |
| :--- | :--- | :--- |
| `sklearn_importance` | HPO –∏ —Ä–∞—Å—á–µ—Ç FI (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç OOB-–æ—Ü–µ–Ω–∫—É). | –ö–æ—Ä—Ç–µ–∂: –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è FI (`pd.Series`), –æ–±—É—á–µ–Ω–Ω–∞—è –º–æ–¥–µ–ª—å (`RandomForestClassifier`), –æ–±—ä–µ–∫—Ç `Optuna Study`. |

-----

### 2\) R Implementations (—Å—Ä–∞–≤–Ω–µ–Ω–∏–µ FI)

#### üî∏ `r_randomforest_importance`

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—É—é —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é **`randomForest`** –≤ R.

```python
from feature_importance_pkg import r_randomforest_importance

fi_r_rf = r_randomforest_importance(
    X, y, 
    n_estimators=500, 
    min_samples_leaf=5
)
print("–í–∞–∂–Ω–æ—Å—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ (%IncMSE) –∏–∑ R (randomForest):\n", fi_r_rf.head())
```

#### üî∏ `r_ranger_importance_air`

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç –±—ã—Å—Ç—Ä—É—é —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é **`ranger`**. –ù–∞—Å—Ç—Ä–æ–µ–Ω–∞ –¥–ª—è **–∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏** –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –º–µ—Ç—Ä–∏–∫—É `impurity_corrected`.

```python
from feature_importance_pkg import r_ranger_importance_air

# –í–∞–∂–Ω–æ: —Ü–µ–ª–µ–≤–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è 'y' –±—É–¥–µ—Ç –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∞ –≤ R-—Ñ–∞–∫—Ç–æ—Ä
fi_r_ranger = r_ranger_importance_air(
    X, y, 
    n_estimators=500, 
    max_features=0.5
)
print("–í–∞–∂–Ω–æ—Å—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ (impurity_corrected) –∏–∑ R (ranger):\n", fi_r_ranger.head())
```

### 3\) –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é `picture` –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Å—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –≥—Ä–∞—Ñ–∏–∫–æ–≤ –≤–∞–∂–Ω–æ—Å—Ç–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –∏–∑ —Ä–∞–∑–Ω—ã—Ö —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–π.

```python
from feature_importance_pkg import picture

# –°–ø–∏—Å–æ–∫ –∏–ª–∏ —Å–ª–æ–≤–∞—Ä—å —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ FI
importance_data = [fi_sklearn, fi_r_rf, fi_r_ranger]

picture(
    importance_data, 
    title="–°—Ä–∞–≤–Ω–µ–Ω–∏–µ –≤–∞–∂–Ω–æ—Å—Ç–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤",
    labels=["Scikit-learn", "R (randomForest)", "R (ranger)"]
)
```

-----

## üîé –ü—Ä–∏–º–µ—Ä—ã –∏ –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã

–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –æ–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ **—Ä–∞–±–æ—á–∏–º —Ç–µ—Ç—Ä–∞–¥—è–º (`notebooks/`)** –∏–ª–∏ —Ç–µ—Å—Ç–æ–≤—ã–º —Å–∫—Ä–∏–ø—Ç–∞–º –≤ –≤–∞—à–µ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ –¥–ª—è –ø–æ—à–∞–≥–æ–≤–æ–≥–æ –ø—Ä–∏–º–µ—Ä–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö –∏ –ø—Ä–æ–≤–µ–¥–µ–Ω–∏—è –ø–æ–ª–Ω–æ–≥–æ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞ –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é –≤–∞–∂–Ω–æ—Å—Ç–∏ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤.

```
```
